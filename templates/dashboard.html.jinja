{% extends "base.html.jinja" %}

{% block title %}–ü–∞–Ω–µ–ª—å —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è{% endblock %}

{% block extra_css %}
<link rel="stylesheet" href="{{ url_for('static', filename='css/dashboard.css') }}">
{% endblock %}

{% block content %}
<div class="dashboard-container">
    <div class="welcome-section">
        <h1 class="dashboard-title">üè† –î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å, {{ g.user.username }}!</h1>
        <p class="dashboard-subtitle">–í–∞—à–∞ –ª–∏—á–Ω–∞—è –ø–∞–Ω–µ–ª—å —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∫–æ–Ω—Ç–µ–Ω—Ç–æ–º</p>
    </div>
    
    <div class="dashboard-grid">
        <!-- Account Management -->
        <div class="dashboard-card">
            <div class="card-header">
                <h3>‚öôÔ∏è –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∞–∫–∫–∞—É–Ω—Ç–æ–º</h3>
            </div>
            <div class="card-content">
                <a href="{{ url_for('profile.update_profile') }}" class="dashboard-action-btn">
                    üîß –ò–∑–º–µ–Ω–∏—Ç—å –ø–∞—Ä–æ–ª—å
                </a>
                <form action="{{ url_for('profile.delete_profile') }}" method="POST" 
                      onsubmit="return confirm('–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ —É–¥–∞–ª–∏—Ç—å —Å–≤–æ–π –∞–∫–∫–∞—É–Ω—Ç? –≠—Ç–æ –¥–µ–π—Å—Ç–≤–∏–µ –Ω–µ–æ–±—Ä–∞—Ç–∏–º–æ.');" 
                      class="delete-form">
                    <input type="submit" value="üóëÔ∏è –£–¥–∞–ª–∏—Ç—å –∞–∫–∫–∞—É–Ω—Ç" class="delete-button">
                </form>
            </div>
        </div>

        <!-- Classes -->
        <div class="dashboard-card">
            <div class="card-header">
                <h3>‚öîÔ∏è –í–∞—à–∏ –ö–ª–∞—Å—Å—ã</h3>
                <span class="item-count">{{ user_classes|length if user_classes else 0 }}</span>
            </div>
            <div class="card-content">
                {% if user_classes %}
                    <div class="items-list">
                        {% for cls in user_classes %}
                            <div class="item-link">
                                <a href="{{ url_for('classes.view_class', class_id=cls.id) }}">{{ cls.name }}</a>
                            </div>
                        {% endfor %}
                    </div>
                {% else %}
                    <p class="empty-message">–í—ã –ø–æ–∫–∞ –Ω–µ —Å–æ–∑–¥–∞–ª–∏ –Ω–∏ –æ–¥–Ω–æ–≥–æ –∫–ª–∞—Å—Å–∞</p>
                {% endif %}
                <a href="{{ url_for('classes.create_class') }}" class="create-btn">‚ûï –°–æ–∑–¥–∞—Ç—å –Ω–æ–≤—ã–π –∫–ª–∞—Å—Å</a>
            </div>
        </div>

        <!-- Subclasses -->
        <div class="dashboard-card">
            <div class="card-header">
                <h3>üìö –í–∞—à–∏ –ü–æ–¥–∫–ª–∞—Å—Å—ã</h3>
                <span class="item-count">{{ user_subclasses|length if user_subclasses else 0 }}</span>
            </div>
            <div class="card-content">
                {% if user_subclasses %}
                    <div class="items-list">
                        {% for sub in user_subclasses %}
                            <div class="item-link">
                                <a href="{{ url_for('subclasses.view_subclass', subclass_id=sub.id) }}">{{ sub.name }}</a>
                                <span class="item-meta">–¥–ª—è {{ sub.parent_class.name }}</span>
                            </div>
                        {% endfor %}
                    </div>
                {% else %}
                    <p class="empty-message">–í—ã –ø–æ–∫–∞ –Ω–µ —Å–æ–∑–¥–∞–ª–∏ –Ω–∏ –æ–¥–Ω–æ–≥–æ –ø–æ–¥–∫–ª–∞—Å—Å–∞</p>
                {% endif %}
                <a href="{{ url_for('subclasses.create_subclass') }}" class="create-btn">‚ûï –°–æ–∑–¥–∞—Ç—å –Ω–æ–≤—ã–π –ø–æ–¥–∫–ª–∞—Å—Å</a>
            </div>
        </div>

        <!-- Races -->
        <div class="dashboard-card">
            <div class="card-header">
                <h3>üßù –í–∞—à–∏ –†–∞—Å—ã</h3>
                <span class="item-count">{{ user_races|length if user_races else 0 }}</span>
            </div>
            <div class="card-content">
                {% if user_races %}
                    <div class="items-list">
                        {% for race in user_races %}
                            <div class="item-link">
                                <a href="{{ url_for('races.view_race', race_id=race.id) }}">{{ race.name }}</a>
                            </div>
                        {% endfor %}
                    </div>
                {% else %}
                    <p class="empty-message">–í—ã –ø–æ–∫–∞ –Ω–µ —Å–æ–∑–¥–∞–ª–∏ –Ω–∏ –æ–¥–Ω–æ–π —Ä–∞—Å—ã</p>
                {% endif %}
                <a href="{{ url_for('races.create_race') }}" class="create-btn">‚ûï –°–æ–∑–¥–∞—Ç—å –Ω–æ–≤—É—é —Ä–∞—Å—É</a>
            </div>
        </div>

        <!-- Food -->
        <div class="dashboard-card">
            <div class="card-header">
                <h3>üçñ –í–∞—à–∞ –ï–¥–∞</h3>
                <span class="item-count">{{ user_foods|length if user_foods else 0 }}</span>
            </div>
            <div class="card-content">
                {% if user_foods %}
                    <div class="items-list">
                        {% for food in user_foods %}
                            <div class="item-link">
                                <a href="{{ url_for('food.view_food', food_id=food.id) }}">{{ food.name }}</a>
                            </div>
                        {% endfor %}
                    </div>
                {% else %}
                    <p class="empty-message">–í—ã –ø–æ–∫–∞ –Ω–µ —Å–æ–∑–¥–∞–ª–∏ –Ω–∏ –æ–¥–Ω–æ–≥–æ —Ä–µ—Ü–µ–ø—Ç–∞</p>
                {% endif %}
                <a href="{{ url_for('food.create_food') }}" class="create-btn">‚ûï –°–æ–∑–¥–∞—Ç—å –Ω–æ–≤—ã–π —Ä–µ—Ü–µ–ø—Ç</a>
            </div>
        </div>

        <!-- Quick Stats -->
        <div class="dashboard-card stats-card">
            <div class="card-header">
                <h3>üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞</h3>
            </div>
            <div class="card-content">
                <div class="stats-grid">
                    <div class="stat-item">
                        <span class="stat-number">{{ (user_classes|length + user_subclasses|length + user_races|length + user_foods|length) if (user_classes or user_subclasses or user_races or user_foods) else 0 }}</span>
                        <span class="stat-label">–í—Å–µ–≥–æ –∫–æ–Ω—Ç–µ–Ω—Ç–∞</span>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}