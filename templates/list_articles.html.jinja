{% extends "base.html.jinja" %}

{% block title %}–°—Ç–∞—Ç—å–∏{% endblock %}

{% block extra_css %}
<link rel="stylesheet" href="{{ url_for('static', filename='css/lists.css') }}">
{% endblock %}

{% block content %}
<div class="list-container">
    <div class="list-header">
        <h1 class="list-title">üìö –ë–∏–±–ª–∏–æ—Ç–µ–∫–∞ –°—Ç–∞—Ç–µ–π</h1>
        <p class="list-subtitle">–ó–Ω–∞–Ω–∏—è –∏ –º—É–¥—Ä–æ—Å—Ç—å –º–∏—Ä–∞ D&D</p>
        {% if g.user %}
            <a href="{{ url_for('articles.create_article') }}" class="create-btn">‚úçÔ∏è –ù–∞–ø–∏—Å–∞—Ç—å —Å—Ç–∞—Ç—å—é</a>
        {% endif %}
    </div>

    {% if articles %}
        <div class="grid-container">
            {% for article in articles %}
                <div class="card">
                    <div class="card-header">
                        <h3 class="card-title">
                            <a href="{{ url_for('articles.view_article', article_id=article.id) }}">
                                {{ article.title }}
                            </a>
                        </h3>
                        <div class="card-meta">
                            <span class="author">üë§ {{ article.user.username }}</span>
                            <span class="date">üìÖ {{ article.created_at.strftime('%d.%m.%Y') }}</span>
                            {% if article.updated_at != article.created_at %}
                                <span class="updated">üîÑ {{ article.updated_at.strftime('%d.%m.%Y') }}</span>
                            {% endif %}
                        </div>
                    </div>
                    
                    <div class="card-footer">
                        <div class="card-stats">
                            <span class="comment-count">üí¨ {{ article.comments.count() }}</span>
                        </div>
                        
                        {% if g.user and (article.user_id == g.user.id or g.user.id in (article.editors_allowed or [])) %}
                            <div class="action-buttons">
                                <a href="{{ url_for('articles.edit_article', article_id=article.id) }}" class="btn btn-edit">
                                    ‚úèÔ∏è –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å
                                </a>
                                {% if article.user_id == g.user.id %}
                                    <a href="{{ url_for('main.grant_edit', content_type='article', content_id=article.id) }}" class="btn btn-grant">
                                        üë• –í—ã–¥–∞—Ç—å –ø—Ä–∞–≤–∞
                                    </a>
                                {% endif %}
                            </div>
                        {% endif %}
                    </div>
                </div>
            {% endfor %}
        </div>
    {% else %}
        <div class="empty-state">
            <div class="empty-icon">üìú</div>
            <h3>–ë–∏–±–ª–∏–æ—Ç–µ–∫–∞ –ø—É—Å—Ç–∞</h3>
            <p>–°—Ç–∞–Ω—å—Ç–µ –ø–µ—Ä–≤—ã–º –∞–≤—Ç–æ—Ä–æ–º! –ü–æ–¥–µ–ª–∏—Ç–µ—Å—å —Å–≤–æ–∏–º–∏ –∑–Ω–∞–Ω–∏—è–º–∏ —Å —Å–æ–æ–±—â–µ—Å—Ç–≤–æ–º.</p>
            {% if g.user %}
                <a href="{{ url_for('articles.create_article') }}" class="create-btn">‚úçÔ∏è –ù–∞–ø–∏—Å–∞—Ç—å –ø–µ—Ä–≤—É—é —Å—Ç–∞—Ç—å—é</a>
            {% else %}
                <p><a href="{{ url_for('auth.login') }}">–í–æ–π–¥–∏—Ç–µ</a>, —á—Ç–æ–±—ã —Å–æ–∑–¥–∞–≤–∞—Ç—å —Å—Ç–∞—Ç—å–∏.</p>
            {% endif %}
        </div>
    {% endif %}
</div>
{% endblock %}
